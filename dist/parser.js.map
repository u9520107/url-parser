{"version":3,"file":"parser.js","sources":["parser.js","@traceur/generated/TemplateParser/6","@traceur/generated/TemplateParser/4","@traceur/generated/TemplateParser/0","@traceur/generated/TemplateParser/1","@traceur/generated/TemplateParser/5","@traceur/generated/TemplateParser/3"],"names":[],"mappings":"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","sourcesContent":["\n/* function parse (path)\n *\t@param path the path and query string after the domain and port\n *\n */\n\nvar commands = {\n\t'where': {\n\t\tencode: 'w',\n\t\ttype: 'multi'\n\t}, \n\t'count': {\n\t\tencode: 'c',\n\t\ttype: 'flag'\n\t}, \n\t'limit': {\n\t\tencode: 'l',\n\t\ttype: 'number'\n\t}, \n\t'orderby': {\n\t\tencode: 'or',\n\t\ttype: 'single'\n\t}, \n\t'field': {\n\t\tencode: 'f',\n\t\ttype: 'multi'\n\t}, \n\t'groupby': {\n\t\tencode: 'g',\n\t\ttype: 'multi'\n\t}, \n\t'offset': {\n\t\tencode: 'o',\n\t\ttype: 'number'\t\n\t}\n\n};\nfunction parse (path) {\n\tvar commands = [];\n\tif(!path) {\n\t\treturn commands;\n\t}\n\tvar resources = path.split('/');\n\tresources.forEach(function (resource) {\n\t\tif(resource==='') {\n\t\t\treturn;\n\t\t}\n\t\tvar obj = {};\n\t\tif(resource.indexOf('?')>-1) {\n\n\t\t\tvar tokens = resource.split('?');\n\t\t\tif(tokens[0]!==''){\n\t\t\t\tobj.name = tokens[0];\n\t\t\t}\n\t\t\ttokens = tokens[1].split('&');\n\t\t\ttokens.forEach(function (token) {\n\t\t\t\tvar idx = token.indexOf('=');\n\t\t\t\tif(idx > -1) {\n\t\t\t\t\tobj[token.substr(0, idx)] = token.substr(idx+1).split(',');\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\tobj[token] = true;\n\t\t\t\t}\n\t\t\t});\t\t\n\t\t}\n\t\telse {\n\t\t\tobj.name = resource;\n\t\t}\n\t\tcommands.push(obj);\n\t});\n\treturn commands;\n}\n\nfunction stringify (op) {\n\tvar resources = [];\n\tif(!Array.isArray(op)) {\n\t\top = [op];\n\t}\n\top.forEach(function (command) {\n\t\tvar tmp = [];\t\n\t\tfor(var key in command) {\n\t\t\tif(key!=='name') {\n\t\t\t\tif(command[key]===true) {\n\t\t\t\t\ttmp.push(key);\t\n\t\t\t\t}\n\t\t\t\telse if(Array.isArray(command[key])) {\n\t\t\t\t\ttmp.push(key + '=' + command[key].join(','));\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\ttmp.push(key + '=' + command[key]);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\ttmp = tmp.length > 0 ? ('?'+tmp.join('&')) : '';\n\t\tresources.push((command.name ? command.name : '') + tmp);\n\t});\n\treturn '/' + resources.join('/');\n}\n\nfunction addQuery(obj, name, op) {\n\tif(!commands.hasOwnProperty(name)) {\n\t\tthrow new Error(name + ' is not a recognized command');\n\t}\n\tvar cmd = commands[name];\n\tswitch(cmd.type) {\n\t\tcase 'multi': \n\t\t\tif(!Array.isArray(op)) {\n\t\t\top = op.split(',');\n\t\t}\n\t\tif(!obj.hasOwnProperty(cmd.encode)) {\n\t\t\tobj[cmd.encode] = op;\n\t\t}\n\t\telse {\n\t\t\tobj[cmd.encode] =  obj[cmd.encode].concat(op);\n\t\t}\n\t\tbreak;\n\t\tcase 'flag': \n\t\t\tif(op===true){\n\t\t\tobj[cmd.encode] = true;\n\t\t}\n\t\telse if(obj.hasOwnProperty(cmd.encode)) {\n\t\t\tdelete obj[cmd.encode];\n\t\t}\n\t\tbreak;\n\t\tcase 'number': \n\t\t\tif(isNaN(op)) {\n\t\t\tthrow new Error(name + ' expect a number');\n\t\t}\n\t\top = parseInt(op);\n\n\t\tif(!obj.hasOwnProperty(cmd.encode)) {\n\t\t\tobj[cmd.encode] = op;\n\t\t}\n\t\telse {\n\t\t\tobj[cmd.encode][0] = op;\n\t\t}\n\t\tbreak;\n\t\tdefault: \n\t\t\tif(Array.isArray(op) || op.indexOf(',')>-1) {\n\t\t\tthrow new Error(name + ' only accept a single value');\n\t\t}\n\n\t\tif(!obj.hasOwnProperty(cmd.encode)) {\n\t\t\tobj[cmd.encode] = op;\n\t\t}\n\t\telse {\n\t\t\tobj[cmd.encode][0] = op;\n\t\t}\n\t\tbreak;\n\t}\n\n}\nfunction setQuery(obj, name, op) {\n\tif(!commands.hasOwnProperty(name)) {\n\t\tthrow new Error(name + ' is not a recognized command');\n\t}\n\tvar cmd = commands[name];\n\tif(obj.hasOwnProperty(cmd.encode)) {\n\t\tdelete obj[cmd.encode];\n\t}\n\taddQuery(obj, name, op);\n}\nfunction getQuery(obj, name) {\n\tif(!commands.hasOwnProperty(name)) {\n\t\tthrow new Error(name + ' is not a recognized command');\n\t}\n\tvar cmd = commands[name];\n\tswitch(cmd.type) {\n\t\tcase 'multi': \n\t\t\tif(!obj.hasOwnProperty(cmd.encode)) {\n\t\t\treturn [];\n\t\t}\n\t\treturn obj[cmd.encode];\n\t\tcase 'flag':\n\t\t\tif(!obj.hasOwnProperty(cmd.encode)) {\n\t\t\treturn false;\n\t\t}\n\t\treturn obj[cmd.encode];\n\t\tcase 'number': \n\t\t\tif(!obj.hasOwnProperty(cmd.encode)) {\n\t\t\treturn null;\n\t\t}\n\t\treturn parseInt(obj[cmd.encode]);\n\t\tdefault:\n\t\t\tif(!obj.hasOwnProperty(cmd.encode)){\n\t\t\treturn '';\n\t\t}\n\t\treturn obj[cmd.encode];\n\t}\n}\n\n\n\nexport {\n\tparse,\n\tstringify,\n\tcommands,\n\taddQuery,\n\tgetQuery,\n\tsetQuery\n};\n","Object.defineProperties(exports, $__placeholder__0);","{get: $__placeholder__0}","get $__placeholder__0() { return $__placeholder__1; }","__esModule: true","{value: $__placeholder__0}","var __moduleName = $__placeholder__0;"]}