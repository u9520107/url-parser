{"version":3,"file":"parser.js","sources":["parser.js","@traceur/generated/TemplateParser/6","@traceur/generated/TemplateParser/4","@traceur/generated/TemplateParser/0","@traceur/generated/TemplateParser/1","@traceur/generated/TemplateParser/5","@traceur/generated/TemplateParser/3"],"names":[],"mappings":"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","sourcesContent":["\r\n/* function parse (path)\r\n *\t@param path the path and query string after the domain and port\r\n *\r\n */\r\n\r\nvar commands = {\r\n\t'where': {\r\n\t\tencode: 'w',\r\n\t\ttype: 'multi'\r\n\t}, \r\n\t'count': {\r\n\t\tencode: 'c',\r\n\t\ttype: 'flag'\r\n\t}, \r\n\t'limit': {\r\n\t\tencode: 'l',\r\n\t\ttype: 'number'\r\n\t}, \r\n\t'orderby': {\r\n\t\tencode: 'or',\r\n\t\ttype: 'single'\r\n\t}, \r\n\t'field': {\r\n\t\tencode: 'f',\r\n\t\ttype: 'multi'\r\n\t}, \r\n\t'groupby': {\r\n\t\tencode: 'g',\r\n\t\ttype: 'multi'\r\n\t}, \r\n\t'offset': {\r\n\t\tencode: 'o',\r\n\t\ttype: 'number'\t\r\n\t}\r\n\r\n};\r\nfunction parse (path) {\r\n\tvar commands = [];\r\n\tif(!path) {\r\n\t\treturn commands;\r\n\t}\r\n\tvar resources = path.split('/');\r\n\tresources.forEach(function (resource) {\r\n\t\tif(resource==='') {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tvar obj = {};\r\n\t\tif(resource.indexOf('?')>-1) {\r\n\r\n\t\t\tvar tokens = resource.split('?');\r\n\t\t\tif(tokens[0]!==''){\r\n\t\t\t\tobj.name = tokens[0];\r\n\t\t\t}\r\n\t\t\ttokens = tokens[1].split('&');\r\n\t\t\ttokens.forEach(function (token) {\r\n\t\t\t\tvar idx = token.indexOf('=');\r\n\t\t\t\tif(idx > -1) {\r\n\t\t\t\t\tobj[token.substr(0, idx)] = token.substr(idx+1).split(',');\r\n\t\t\t\t}\r\n\t\t\t\telse {\r\n\t\t\t\t\tobj[token] = true;\r\n\t\t\t\t}\r\n\t\t\t});\t\t\r\n\t\t}\r\n\t\telse {\r\n\t\t\tobj.name = resource;\r\n\t\t}\r\n\t\tcommands.push(obj);\r\n\t});\r\n\treturn commands;\r\n}\r\n\r\nfunction stringify (commands) {\r\n\tvar resources = [];\r\n\tif(!Array.isArray(commands)) {\r\n\t\tthrow new Error('commands must be an array');\r\n\t}\r\n\tcommands.forEach(function (command) {\r\n\t\tvar tmp = [];\t\r\n\t\tfor(var key in command) {\r\n\t\t\tif(key!=='name') {\r\n\t\t\t\tif(command[key]===true) {\r\n\t\t\t\t\ttmp.push(key);\t\r\n\t\t\t\t}\r\n\t\t\t\telse if(Array.isArray(command[key])) {\r\n\t\t\t\t\ttmp.push(key + '=' + command[key].join(','));\r\n\t\t\t\t}\r\n\t\t\t\telse {\r\n\t\t\t\t\ttmp.push(key + '=' + command[key]);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\ttmp = tmp.length > 0 ? ('?'+tmp.join('&')) : '';\r\n\t\tresources.push((command.name ? command.name : '') + tmp);\r\n\t});\r\n\treturn '/' + resources.join('/');\r\n}\r\n\r\nfunction addQuery(obj, name, op) {\r\n\tif(!commands.hasOwnProperty(name)) {\r\n\t\tthrow new Error(name + ' is not a recognized command');\r\n\t}\r\n\tvar cmd = commands[name];\r\n\tswitch(cmd.type) {\r\n\t\tcase 'multi': \r\n\t\t\tif(!Array.isArray(op)) {\r\n\t\t\top = op.split(',');\r\n\t\t}\r\n\t\tif(!obj.hasOwnProperty(cmd.encode)) {\r\n\t\t\tobj[cmd.encode] = op;\r\n\t\t}\r\n\t\telse {\r\n\t\t\tobj[cmd.encode] =  obj[cmd.encode].concat(op);\r\n\t\t}\r\n\t\tbreak;\r\n\t\tcase 'flag': \r\n\t\t\tif(!obj.hasOwnProperty(cmd.encode)) {\r\n\t\t\tobj[cmd.encode] = true;\r\n\t\t}\r\n\t\tbreak;\r\n\t\tcase 'number': \r\n\t\t\tif(isNaN(op)) {\r\n\t\t\tthrow new Error(name + ' expect a number');\r\n\t\t}\r\n\t\top = parseInt(op);\r\n\r\n\t\tif(!obj.hasOwnProperty(cmd.encode)) {\r\n\t\t\tobj[cmd.encode] = op;\r\n\t\t}\r\n\t\telse {\r\n\t\t\tobj[cmd.encode][0] = op;\r\n\t\t}\r\n\t\tbreak;\r\n\t\tdefault: \r\n\t\t\tif(Array.isArray(op) || op.indexOf(',')>-1) {\r\n\t\t\tthrow new Error(name + ' only accept a single value');\r\n\t\t}\r\n\r\n\t\tif(!obj.hasOwnProperty(cmd.encode)) {\r\n\t\t\tobj[cmd.encode] = op;\r\n\t\t}\r\n\t\telse {\r\n\t\t\tobj[cmd.encode][0] = op;\r\n\t\t}\r\n\t\tbreak;\r\n\t}\r\n\r\n}\r\nfunction setQuery(obj, name, op) {\r\n\tif(!commands.hasOwnProperty(name)) {\r\n\t\tthrow new Error(name + ' is not a recognized command');\r\n\t}\r\n\tif(obj.hasOwnProperty(name)) {\r\n\t\tdelete obj[name];\r\n\t}\r\n\taddQuery(obj, name, op);\r\n}\r\nfunction getQuery(obj, name) {\r\n\tif(!commands.hasOwnProperty(name)) {\r\n\t\tthrow new Error(name + ' is not a recognized command');\r\n\t}\r\n\tvar cmd = commands[name];\r\n\tswitch(cmd.type) {\r\n\t\tcase 'multi': \r\n\t\t\tif(!obj.hasOwnProperty(cmd.encode)) {\r\n\t\t\treturn '';\r\n\t\t}\r\n\t\treturn obj[cmd.encode].join(',');\r\n\t\tcase 'flag':\r\n\t\t\tif(!obj.hasOwnProperty(cmd.encode)) {\r\n\t\t\treturn false;\r\n\t\t}\r\n\t\treturn obj[cmd.encode];\r\n\t\tcase 'number': \r\n\t\t\tif(!obj.hasOwnProperty(cmd.encode)) {\r\n\t\t\treturn null;\r\n\t\t}\r\n\t\treturn parseInt(obj[cmd.encode]);\r\n\t\tdefault:\r\n\t\t\tif(!obj.hasOwnProperty(cmd.encode)){\r\n\t\t\treturn '';\r\n\t\t}\r\n\t\treturn obj[cmd.encode];\r\n\t}\r\n}\r\n\r\n\r\n\r\nexport {\r\n\tparse,\r\n\tstringify,\r\n\tcommands,\r\n\taddQuery,\r\n\tgetQuery,\r\n\tsetQuery\r\n};\r\n","Object.defineProperties(exports, $__placeholder__0);","{get: $__placeholder__0}","get $__placeholder__0() { return $__placeholder__1; }","__esModule: true","{value: $__placeholder__0}","var __moduleName = $__placeholder__0;"]}